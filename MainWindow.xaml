<Window x:Class="EuromagProtocolUtility.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:EuromagProtocolUtility"
        mc:Ignorable="d"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:myAttachedProperties="clr-namespace:EuromagProtocolUtility.Tools"
        TextElement.Foreground="{DynamicResource MaterialDesignBody}"
        TextElement.FontWeight="Regular"
        TextElement.FontSize="13"
        TextOptions.TextFormattingMode="Ideal" 
        TextOptions.TextRenderingMode="Auto"        
        Background="#F1F1F1"
        FontFamily="{DynamicResource MaterialDesignFont}"
        Title="Euromag Protocol Utility" Height="800" Width="1200">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition/>
            <RowDefinition Height="0.6*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <TabControl Style="{StaticResource MaterialDesignNavigationRailTabControl}"
                    SelectionChanged="TabControl_SelectionChanged">
            <TabItem x:Name="ParamsTab"
             Header="{materialDesign:PackIcon Kind=Database, Size=24}"
             Style="{StaticResource MaterialDesignNavigationRailTabItem}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition/>
                    </Grid.RowDefinitions>
                    <TextBlock Text="Lista Parametri EEProm Da XML" 
                               Style="{DynamicResource MaterialDesignHeadline6TextBlock}"
                               Margin="10"/>
                    <Button x:Name="OpenEditorBtn"   
                            Visibility="Collapsed"
                            IsEnabled="{Binding CommResources.ControlsEnable}"
                            HorizontalAlignment="Right"
                            Margin="5"     
                            ToolTip="Apri Editor XML per MagNet"
                            Style="{DynamicResource MaterialDesignRaisedDarkButton}"
                            Click="OpenEditorBtn_Click">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon
                                            Kind="Pencil"
                                            VerticalAlignment="Center"/>
                            <TextBlock Text="MagNet Editor" Margin="2" Height="Auto"/>
                        </StackPanel>
                    </Button>
                    <Grid Margin="10"
                      Grid.Row="1">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition/>
                            <ColumnDefinition Width="1.5*"/>
                        </Grid.ColumnDefinitions>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Button x:Name="ImportButton"                
                                    Margin="5"     
                                    ToolTip="Apri XML"
                                    Style="{DynamicResource MaterialDesignRaisedDarkButton}"
                                    Command="{Binding CommResources.OpenXMLFileCmd}">
                                <StackPanel Orientation="Horizontal">
                                    <materialDesign:PackIcon
                                                    Kind="Import"
                                                    VerticalAlignment="Center"/>
                                    <TextBlock Text="Apri File Xml" Margin="2" Height="Auto"/>
                                </StackPanel>
                            </Button>
                            <Button x:Name="ExportButton"  
                                    Grid.Column="1"
                                    Margin="5"     
                                    ToolTip="Crea CSV"
                                    Style="{DynamicResource MaterialDesignRaisedDarkButton}"
                                    Command="{Binding CommResources.BuildCsvFileCmd}">
                                <StackPanel Orientation="Horizontal">
                                    <materialDesign:PackIcon
                                                    Kind="FileCsv"
                                                    VerticalAlignment="Center"/>
                                    <TextBlock Text="Crea File CSV" Margin="2" Height="Auto"/>
                                </StackPanel>
                            </Button>
                            <Button x:Name="CodeGenButton"  
                                    Grid.Column="2"
                                    Margin="5"     
                                    ToolTip="Crea .C"
                                    Style="{DynamicResource MaterialDesignRaisedDarkButton}"
                                    Command="{Binding CommResources.BuildCFileCmd}">
                                <StackPanel Orientation="Horizontal">
                                    <materialDesign:PackIcon
                                                    Kind="FileCode"
                                                    VerticalAlignment="Center"/>
                                    <TextBlock Text="Crea File .C" Margin="2" Height="Auto"/>
                                </StackPanel>
                            </Button>
                        </Grid>
                        <Grid Grid.Row="1">
                            <Grid.RowDefinitions>
                                <RowDefinition/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <ScrollViewer Margin="10">
                                <DataGrid x:Name="parametersGrid" 
                                      AlternatingRowBackground="LightGray"
                                      IsReadOnly="True"
                                      AutoGenerateColumns="False"
                                      SelectionChanged="parametersGrid_SelectionChanged"
                                      ItemsSource="{Binding CommResources.DeviceParametersViewFiltered}">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Descrizione" 
                                        Binding="{Binding Description, Mode=OneWay}" 
                                        Width="auto"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </ScrollViewer>
                            <materialDesign:ColorZone Grid.Row="1"
                    Background="LightGray"
                    Padding="16" Margin="10,0,10,10">
                                <DockPanel>
                                    <materialDesign:ColorZone
                                            materialDesign:ElevationAssist.Elevation="Dp3"
                                            Mode="Standard"
                                            Padding="8 4 8 4"
                                            CornerRadius="2"
                                            Panel.ZIndex="1">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition/>
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            <Button x:Name="ParFilterButton"
                                Style="{DynamicResource MaterialDesignToolButton}">
                                                <materialDesign:PackIcon
                                        Kind="Magnify"
                                        Opacity=".56" VerticalAlignment="Center"/>
                                            </Button>
                                            <TextBox x:Name="ParFilterBox"
                                Grid.Column="1"
                                Margin="8 0 0 0"
                                materialDesign:HintAssist.Hint="Filter" 
                                materialDesign:TextFieldAssist.DecorationVisibility="Hidden"
                                BorderThickness="0"
                                MinWidth="200"
                                VerticalAlignment="Center"
                                TextChanged="ParFilterBox_TextChanged"
                                Text="{Binding CommResources.DeviceParametersFilter}" Cursor="Arrow"/>
                                        </Grid>
                                    </materialDesign:ColorZone>
                                </DockPanel>
                            </materialDesign:ColorZone>
                        </Grid>
                        <materialDesign:ColorZone
            Background="LightGray"
            Height="Auto"
            VerticalAlignment="Stretch"
            materialDesign:ElevationAssist.Elevation="Dp1"
            CornerRadius="3"
            Grid.Column="1"
            Margin="10,5,10,5">
                            <TextBlock Text="{Binding CommResources.ParDescription}"
                       FontWeight="Bold"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center"/>
                        </materialDesign:ColorZone>
                        <ScrollViewer Grid.Row="1"                                  
                                  Grid.Column="1">
                            <StackPanel Orientation="Vertical"
            Grid.Row="1"
            Grid.Column="1">
                                <materialDesign:Card Grid.Row="1" 
                                               VerticalAlignment="Top"
                                               materialDesign:ElevationAssist.Elevation="Dp3"
                                               Grid.Column="1"
                                               Margin="10">
                                    <Grid Margin="10"
                                    VerticalAlignment="Top">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition/>
                                            <ColumnDefinition/>
                                            <ColumnDefinition/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition/>
                                            <RowDefinition/>
                                            <RowDefinition/>
                                            <RowDefinition/>
                                            <RowDefinition/>
                                            <RowDefinition/>
                                            <RowDefinition/>
                                            <RowDefinition/>
                                            <RowDefinition/>
                                            <RowDefinition/>
                                            <RowDefinition/>
                                        </Grid.RowDefinitions>
                                        <TextBlock Text="Indice file XML" 
                                             Margin="5" 
                                             Grid.Row="0"/>
                                        <TextBlock Text="{Binding CommResources.ParFileID}" 
                                             Margin="5" 
                                             Grid.Row="0"
                                             Grid.Column="1"/>
                                        <TextBlock Text="Tipo" 
                                             FontWeight="Bold"
                                             Margin="5" 
                                             Grid.Row="2"/>
                                        <TextBlock Text="{Binding CommResources.ParDataType}" 
                                             Margin="5" 
                                             Grid.Row="2"
                                             Grid.Column="1"/>
                                        <ScrollViewer Margin="10" 
                                                Visibility="{Binding CommResources.ParOptionsListVisibility}"
                                                Grid.Column="2"
                                                Grid.Row="2"
                                                Grid.RowSpan="8"
                                                Height="150">
                                            <DataGrid ItemsSource="{Binding CommResources.ParOptionsList}"
                                                  AutoGenerateColumns="True"
                                                  IsReadOnly="True"
                                                  AlternatingRowBackground="LightGray"/>
                                        </ScrollViewer>
                                        <TextBlock Text="Nome" 
                                               Margin="5" 
                                               Grid.Row="1"/>
                                        <TextBlock Text="{Binding CommResources.ParName}" 
                                               Margin="5" 
                                               Grid.Row="1"
                                               Grid.Column="1"/>
                                        <TextBlock Text="Indirizzo EEPROM" 
                                               Margin="5" 
                                               Grid.Row="4"/>
                                        <TextBlock Text="{Binding CommResources.ParEEPRomId}" 
                               Margin="5" 
                               Grid.Row="4"
                               Grid.Column="1"/>
                                        <TextBlock Text="Indirizzo Protocollo" 
   FontWeight="Bold"
   Margin="5" 
   Grid.Row="5"/>
                                        <TextBlock Text="{Binding CommResources.ParProtocolId}" 
   Margin="5" 
   Grid.Row="5"
   Grid.Column="1"/>
                                        <TextBlock Text="Valore di Default" 
   Margin="5" 
   Grid.Row="6"/>
                                        <TextBlock Text="{Binding CommResources.ParDefault}" 
   Margin="5" 
   Grid.Row="6"
   Grid.Column="1"/>
                                        <TextBlock Text="Massimo" 
   Margin="5" 
   Grid.Row="7"/>
                                        <TextBlock Text="{Binding CommResources.ParMax}" 
   Margin="5" 
   Grid.Row="7"
   Grid.Column="1"/>
                                        <TextBlock Text="Minimo" 
   Margin="5" 
   Grid.Row="8"/>
                                        <TextBlock Text="{Binding CommResources.ParMin}" 
   Margin="5" 
   Grid.Row="8"
   Grid.Column="1"/>
                                        <TextBlock Text="Valore" 
   Margin="5" 
   Grid.Row="9"/>
                                        <TextBox Text="{Binding CommResources.ParValue}" 
   Margin="5" 
   Grid.Row="9"
   Grid.Column="1"/>
                                        <Grid 
                                Grid.Row="10"
                                Grid.ColumnSpan="3">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition/>
                                                <ColumnDefinition/>
                                            </Grid.ColumnDefinitions>
                                            <Button x:Name="GSMReadPar" 
                            IsEnabled="{Binding CommResources.ControlsEnable}"
Grid.Row="10"
Margin="5"     
ToolTip="Apri XML"
Style="{DynamicResource MaterialDesignRaisedDarkButton}"
Command="{Binding CommResources.ReadParCmd}">
                                                <StackPanel Orientation="Horizontal">
                                                    <materialDesign:PackIcon
        Kind="Download"
        VerticalAlignment="Center"/>
                                                    <TextBlock Text="Frame Lettura" Margin="2" Height="Auto"/>
                                                </StackPanel>
                                            </Button>
                                            <Button x:Name="GSMWritePar"   
                            IsEnabled="{Binding CommResources.ControlsEnable}"
Grid.Row="10"
    Grid.Column="1"
Margin="5"     
ToolTip="Apri XML"
Style="{DynamicResource MaterialDesignRaisedDarkButton}"
Command="{Binding CommResources.WriteParCmd}">
                                                <StackPanel Orientation="Horizontal">
                                                    <materialDesign:PackIcon
        Kind="Upload"
        VerticalAlignment="Center"/>
                                                    <TextBlock Text="Frame Scrittura" Margin="2" Height="Auto"/>
                                                </StackPanel>
                                            </Button>
                                        </Grid>

                                    </Grid>
                                </materialDesign:Card>
                            </StackPanel>
                        </ScrollViewer>
                    </Grid>
                </Grid>
            </TabItem>
            <TabItem x:Name="BundleEEpromTab"
                     IsEnabled="{Binding CommResources.ControlsEnable}"
                     Header="{materialDesign:PackIcon Kind=ViewList, Size=24}"
                     Style="{StaticResource MaterialDesignNavigationRailTabItem}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <TextBlock Text="Lista Bundles EEProm" 
                               Style="{DynamicResource MaterialDesignHeadline6TextBlock}"
                               Margin="10"/>
                    <Grid
                        Grid.Row="1">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition/>
                            <ColumnDefinition/>
                        </Grid.ColumnDefinitions>
                        <materialDesign:ColorZone
                                 Background="LightGray"
                                 Height="Auto"
                                 VerticalAlignment="Stretch"
                                 materialDesign:ElevationAssist.Elevation="Dp1"
                                 CornerRadius="3"
                                 Grid.Column="1"
                                Margin="10,5,10,5">
                            <TextBlock 
                                        Margin="10"
                                        FontWeight="Bold"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center">
                                <Run Text="Indirizzo Bundle:" FontWeight="Bold"/>
                                <Run Text="{Binding CommResources.BundleIndex}" FontWeight="Normal"/>
                                <Run Text=" "/>
                                <Run Text="Range Indirizzi EEPROM:" FontWeight="Bold"/>
                                <Run Text="{Binding CommResources.BundleSpanStart}" FontWeight="Normal"/>
                                <Run Text="-" FontWeight="Normal"/>
                                <Run Text="{Binding CommResources.BundleSpanStop}" FontWeight="Normal"/>
                            </TextBlock>
                        </materialDesign:ColorZone>
                        <ScrollViewer Grid.Row="1"
                                      Margin="10">
                            <DataGrid x:Name="BundleListGrid"
                                      Margin="10"
                                      AlternatingRowBackground="LightGray"
                                      IsReadOnly="True"
                                      AutoGenerateColumns="False"
                                      SelectionChanged="BundleListGrid_SelectionChanged"
                                      ItemsSource="{Binding CommResources.DeviceEEpromBundlesView}">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Nome Bundle" 
                                       Binding="{Binding Name, Mode=OneWay}" 
                                       Width="auto"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </ScrollViewer>
                        <ScrollViewer Grid.Row="1"
                                      Grid.Column="1"
                                      Margin="10">
                            <DataGrid x:Name="BundleParListGrid"
                                      Margin="10"
                                      AlternatingRowBackground="LightGray"
                                      IsReadOnly="True"
                                      AutoGenerateColumns="False"
                                      SelectionChanged="BundleListGrid_SelectionChanged"
                                      ItemsSource="{Binding CommResources.DeviceEEpromBundlesListView}">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Parametro" 
                                        Binding="{Binding Description, Mode=OneWay}" 
                                        Width="auto"/>
                                    <DataGridTextColumn Header="Valore" 
                                        Binding="{Binding ValAsString, Mode=OneWay}" 
                                        Width="auto"/>

                                </DataGrid.Columns>
                            </DataGrid>
                        </ScrollViewer>
                        <materialDesign:Card x:Name="FrameBundleCard"
                                              Margin="10"
                                              materialDesign:ElevationAssist.Elevation="Dp3"
                                              VerticalAlignment="Bottom"
                                              Grid.Row="3"
                                              Grid.ColumnSpan="2"/>
                    </Grid>
                </Grid>
            </TabItem>
            <TabItem x:Name="VariablesTab"
                     IsEnabled="{Binding CommResources.ControlsEnable}"
                     Header="{materialDesign:PackIcon Kind=Memory, Size=24}"
                     Style="{StaticResource MaterialDesignNavigationRailTabItem}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <TextBlock Text="Lista Variabili RAM" 
                               Style="{DynamicResource MaterialDesignHeadline6TextBlock}"
                               Margin="10"/>
                    <Grid Grid.Row="1">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition/>
                        </Grid.RowDefinitions>
                        <ScrollViewer Grid.RowSpan="2">
                            <DataGrid x:Name="VariableListGrid"
                                      Margin="10"
                                      AlternatingRowBackground="LightGray"
                                      IsReadOnly="True"
                                      AutoGenerateColumns="False"
                                      SelectionChanged="VariableListGrid_SelectionChanged"
                                      ItemsSource="{Binding CommResources.DeviceVariablesView}">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Nome" 
                                       Binding="{Binding Name, Mode=OneWay}" 
                                       Width="auto"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </ScrollViewer>
                        <materialDesign:ColorZone
                                Background="LightGray"
                                Height="Auto"
                                VerticalAlignment="Stretch"
                                materialDesign:ElevationAssist.Elevation="Dp1"
                                CornerRadius="3"
                                Grid.Column="1"
                                Margin="10,5,10,5">
                            <TextBlock Text="{Binding CommResources.VarName}"
                                       Margin="10"
                                       FontWeight="Bold"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Center"/>
                        </materialDesign:ColorZone>
                        <ScrollViewer Grid.Row="1"
                                          Grid.Column="1">
                            <StackPanel Orientation="Vertical">
                                <materialDesign:Card x:Name="VariableInfoCard"
                                                     Margin="10">
                                    <Grid Margin="10">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition/>
                                            <ColumnDefinition/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition/>
                                            <RowDefinition/>
                                            <RowDefinition/>
                                            <RowDefinition/>
                                        </Grid.RowDefinitions>
                                        <TextBlock Text="Nome" 
                                                   Margin="5" 
                                                   Grid.Row="0"/>
                                        <TextBlock Text="{Binding CommResources.VarName}" 
                                                   Margin="5" 
                                                   Grid.Column="1"
                                                   Grid.Row="0"/>
                                        <TextBlock Text="Tipo" 
                                                   Margin="5" 
                                                   Grid.Row="1"/>
                                        <TextBlock Text="{Binding CommResources.VarType}" 
                                                   Margin="5" 
                                                   Grid.Column="1"
                                                   Grid.Row="1"/>
                                        <TextBlock Text="Indirizzo protocollo" 
                                                   FontWeight="Bold"
                                                   Margin="5" 
                                                   Grid.Row="2"/>
                                        <TextBlock Text="{Binding CommResources.VarAddress}" 
                                                   Margin="5" 
                                                   Grid.Column="1"
                                                   Grid.Row="2"/>
                                        <Button x:Name="ReadVar"   
                                                Grid.Row="10"
                                                Grid.ColumnSpan="2"
                                                Margin="5"     
                                                ToolTip="Apri XML"
                                                Style="{DynamicResource MaterialDesignRaisedDarkButton}"
                                                Command="{Binding CommResources.ReadVarCmd}">
                                            <StackPanel Orientation="Horizontal">
                                                <materialDesign:PackIcon
                                                                Kind="Download"
                                                                VerticalAlignment="Center"/>
                                                <TextBlock Text="Frame Lettura" Margin="2" Height="Auto"/>
                                            </StackPanel>
                                        </Button>
                                    </Grid>
                                </materialDesign:Card>
                            </StackPanel>
                        </ScrollViewer>
                    </Grid>
                </Grid>
            </TabItem>
            <TabItem x:Name="BundleRamTab"
                     IsEnabled="{Binding CommResources.ControlsEnable}"
                     Header="{materialDesign:PackIcon Kind=ViewListOutline, Size=24}"
                     Style="{StaticResource MaterialDesignNavigationRailTabItem}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <TextBlock Text="Lista Bundles RAM" 
                               Style="{DynamicResource MaterialDesignHeadline6TextBlock}"
                               Margin="10"/>
                    <Grid
                        Grid.Row="1">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition/>
                            <ColumnDefinition/>
                        </Grid.ColumnDefinitions>
                        <materialDesign:ColorZone
                                 Background="LightGray"
                                 Height="Auto"
                                 VerticalAlignment="Stretch"
                                 materialDesign:ElevationAssist.Elevation="Dp1"
                                 CornerRadius="3"
                                 Grid.Column="1"
                                Margin="10,5,10,5">
                            <TextBlock 
                                        Margin="10"
                                        FontWeight="Bold"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center">
                                <Run Text="Indirizzo Bundle: " FontWeight="Bold"/>
                                <Run Text="{Binding CommResources.BundleRamIndex}" FontWeight="Normal"/>
                            </TextBlock>
                        </materialDesign:ColorZone>
                        <ScrollViewer Grid.Row="1"
                                      Margin="10">
                            <DataGrid x:Name="BundleRamListGrid"
                                      Margin="10"
                                      AlternatingRowBackground="LightGray"
                                      IsReadOnly="True"
                                      AutoGenerateColumns="False"
                                      SelectionChanged="BundleRamListGrid_SelectionChanged"
                                      ItemsSource="{Binding CommResources.DeviceRamBundlesView}">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Nome Bundle" 
                                                        Binding="{Binding Name, Mode=OneWay}" 
                                                        Width="auto"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </ScrollViewer>
                        <ScrollViewer Grid.Row="1"
                                      Grid.Column="1"
                                      Margin="10">
                            <DataGrid x:Name="BundleRamParListGrid"
                                        Margin="10"
                                        AlternatingRowBackground="LightGray"
                                        IsReadOnly="True"
                                        AutoGenerateColumns="False"
                                        SelectionChanged="BundleListGrid_SelectionChanged"
                                        ItemsSource="{Binding CommResources.DeviceRamBundlesListView}">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Parametro" 
                                                        Binding="{Binding Description, Mode=OneWay}" 
                                                        Width="auto"/>
                                    <DataGridTextColumn Header="Valore" 
                                                        Binding="{Binding ValAsString, Mode=OneWay}" 
                                                        Width="auto"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </ScrollViewer>
                    </Grid>
                </Grid>
            </TabItem>
            <TabItem x:Name="GSMTab"
                     IsEnabled="{Binding CommResources.ControlsEnable}"
                     Header="{materialDesign:PackIcon Kind=Signal, Size=24}"
                     Style="{StaticResource MaterialDesignNavigationRailTabItem}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <TextBlock Text="Gestione GSM" 
                               Style="{DynamicResource MaterialDesignHeadline6TextBlock}"
                               Margin="10"/>
                    <Grid Grid.Row="1">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="0.6*"/>
                            <ColumnDefinition/>
                        </Grid.ColumnDefinitions>
                        <ComboBox ItemsSource="{Binding CommResources.GsmCommandTypes}"
                                    SelectedValue="{Binding CommResources.GsmCommandType}"
                                    Margin="5"/>
                        <ScrollViewer Margin="10"
                                      Grid.Row="1">
                            <Grid>
                                <DataGrid x:Name="GSMParametersGrid" 
                                      Visibility="{Binding CommResources.GsmParamVisibility}"
                                      AlternatingRowBackground="LightGray"
                                      IsReadOnly="True"
                                      AutoGenerateColumns="False"
                                      SelectionChanged="GSMParametersGrid_SelectionChanged"
                                      ItemsSource="{Binding CommResources.GsmParametersView}">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Descrizione" 
                                                    Binding="{Binding Name, Mode=OneWay}" 
                                                    Width="auto"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                                <DataGrid x:Name="GSMVariablesGrid" 
          Visibility="{Binding CommResources.GsmVariableVisibility}"
          AlternatingRowBackground="LightGray"
          IsReadOnly="True"
          AutoGenerateColumns="False"
          SelectionChanged="GSMVariablesGrid_SelectionChanged"
          ItemsSource="{Binding CommResources.GsmVariablesView}">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Descrizione" 
                        Binding="{Binding Name, Mode=OneWay}" 
                        Width="auto"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Grid>
                        </ScrollViewer>
                        <ScrollViewer Grid.Row="1"                                  
                                      Grid.Column="1">
                            <StackPanel Orientation="Vertical"
                                          Grid.Row="1"
                                          Grid.Column="1">
                                <materialDesign:Card x:Name="SetGSMmodeCard"
                                                     Margin="10">
                                    <Grid Margin="10">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition/>
                                            <ColumnDefinition/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition/>
                                            <RowDefinition/>
                                        </Grid.RowDefinitions>
                                        <TextBlock Text="Attiva modalità debug GSM"
                                                   VerticalAlignment="Center"/>
                                        <Button x:Name="SendDebugModeCmdBtn"   
                                                        IsEnabled="{Binding CommResources.ControlsEnable}"                                                        
                                                        Grid.Column="1"
                                                        Margin="5"                                                             
                                                        Style="{DynamicResource MaterialDesignRaisedDarkButton}"
                                                        Command="{Binding CommResources.EnterGSMConfigurationModeCmd}">
                                            <StackPanel Orientation="Horizontal">
                                                <materialDesign:PackIcon
                                                                Kind="Upload"
                                                                VerticalAlignment="Center"/>
                                                <TextBlock Text="Frame Scrittura" 
                                                           Margin="2" 
                                                           Height="Auto"/>
                                            </StackPanel>
                                        </Button>
                                        <TextBlock Text="Disattiva modalità debug GSM"
                                                   Grid.Row="1"
                                                   VerticalAlignment="Center"/>
                                        <Button x:Name="SendDebugModeOffCmdBtn"   
                                                        IsEnabled="{Binding CommResources.ControlsEnable}"                                                        
                                                        Grid.Column="1"
                                                        Grid.Row="1"
                                                        Margin="5"                                                             
                                                        Style="{DynamicResource MaterialDesignRaisedDarkButton}"
                                                        Command="{Binding CommResources.ExitGSMConfigurationModeCmd}">
                                            <StackPanel Orientation="Horizontal">
                                                <materialDesign:PackIcon
                                                                Kind="Upload"
                                                                VerticalAlignment="Center"/>
                                                <TextBlock Text="Frame Scrittura" 
                                                           Margin="2" 
                                                           Height="Auto"/>
                                            </StackPanel>
                                        </Button>

                                    </Grid>
                                </materialDesign:Card>
                                <materialDesign:Card Grid.Row="1"
                                                       VerticalAlignment="Top"
                                                       materialDesign:ElevationAssist.Elevation="Dp3"
                                                       Grid.Column="1"
                                                       Margin="10">
                                    <Grid Margin="10" 
VerticalAlignment="Top">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition/>
                                            <RowDefinition/>
                                            <RowDefinition/>
                                            <RowDefinition/>
                                            <RowDefinition/>
                                            <RowDefinition/>
                                            <RowDefinition/>
                                        </Grid.RowDefinitions>
                                        <TextBlock Text="Indice" 
         Margin="5" 
         Grid.Row="0"/>
                                        <TextBlock Text="{Binding CommResources.ParGsmID}" 
         Margin="5" 
         Grid.Row="0"
         Grid.Column="1"/>
                                        <TextBlock Text="Tipo" 
                                     FontWeight="Bold"
                                     Margin="5" 
                                     Grid.Row="2"/>
                                        <TextBlock Text="{Binding CommResources.ParGsmDataType}" 
                                     Margin="5" 
                                     Grid.Row="2"
                                     Grid.Column="1"/>

                                        <TextBlock Text="Nome" 
                                     Margin="5" 
                                     Grid.Row="1"/>
                                        <TextBlock Text="{Binding CommResources.ParGsmName}" 
                                     Margin="5" 
                                     Grid.Row="1"
                                     Grid.Column="1"/>
                                        <TextBlock Text="{Binding CommResources.ParGsmAddress}" 
                                     Margin="5" 
                                     Grid.Row="4"
                                     Grid.Column="1"/>
                                        <TextBlock Text="Indirizzo Protocollo" 
         FontWeight="Bold"
         Margin="5" 
         Grid.Row="4"/>

                                        <TextBlock Text="{Binding CommResources.ParDefault}" 
         Margin="5" 
         Grid.Row="6"
         Grid.Column="1"/>
                                        <TextBlock Text="{Binding CommResources.ParMax}" 
         Margin="5" 
         Grid.Row="7"
         Grid.Column="1"/>
                                        <TextBlock Text="{Binding CommResources.ParMin}" 
         Margin="5" 
         Grid.Row="8"
         Grid.Column="1"/>
                                        <TextBlock Text="Valore" 
         Margin="5" 
         Grid.Row="5"/>
                                        <TextBox Text="{Binding CommResources.ParGsmValue}" 
         Margin="5" 
         Grid.Row="5"
         Grid.Column="1"/>
                                        <Grid 
                                      Grid.Row="6"
                                      Grid.ColumnSpan="3">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition/>
                                                <ColumnDefinition/>
                                            </Grid.ColumnDefinitions>
                                            <Button x:Name="ReadPar" 
                                  IsEnabled="{Binding CommResources.ControlsEnable}"
      Grid.Row="10"
      Margin="5"     
      ToolTip="Apri XML"
      Style="{DynamicResource MaterialDesignRaisedDarkButton}"
      Command="{Binding CommResources.ReadGsmParCmd}">
                                                <StackPanel Orientation="Horizontal">
                                                    <materialDesign:PackIcon
              Kind="Download"
              VerticalAlignment="Center"/>
                                                    <TextBlock Text="Frame Lettura" Margin="2" Height="Auto"/>
                                                </StackPanel>
                                            </Button>
                                            <Button x:Name="WritePar"   
                                  IsEnabled="{Binding CommResources.ControlsEnable}"
      Grid.Row="10"
          Grid.Column="1"
      Margin="5"     
      ToolTip="Apri XML"
      Style="{DynamicResource MaterialDesignRaisedDarkButton}"
      Command="{Binding CommResources.WriteGsmParCmd}">
                                                <StackPanel Orientation="Horizontal">
                                                    <materialDesign:PackIcon
              Kind="Upload"
              VerticalAlignment="Center"/>
                                                    <TextBlock Text="Frame Scrittura" Margin="2" Height="Auto"/>
                                                </StackPanel>
                                            </Button>
                                        </Grid>

                                    </Grid>
                                </materialDesign:Card>
                            </StackPanel>
                        </ScrollViewer>
                    </Grid>
                </Grid>
            </TabItem>
            <TabItem x:Name="SettingsTab"                     
                     Header="{materialDesign:PackIcon Kind=Cog, Size=24}"
                     Style="{StaticResource MaterialDesignNavigationRailTabItem}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <TextBlock Text="Impostazioni" 
                               Style="{DynamicResource MaterialDesignHeadline6TextBlock}"
                               Margin="10"/>
                    <materialDesign:Card x:Name="SettingsCard" 
                                         Grid.Row="1"                                         
                                         Margin="10">
                        <Grid Margin="10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition/>
                                <ColumnDefinition/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition/>
                                <RowDefinition/>
                            </Grid.RowDefinitions>
                            <Grid x:Name="ComPortSetting">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition/>
                                    <ColumnDefinition/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="Porta Seriale"
                                           VerticalAlignment="Center"
                                           Margin="10"/>
                                <ComboBox x:Name="ComPortSelection" 
                                            Grid.Column="1"                                            
                                            IsEditable="False"
                                            ItemsSource="{Binding CommResources.SerialPortsCom}" 
                                            SelectedItem="{Binding UserCommPort}"                                 >
                                </ComboBox>
                                <Button x:Name="SavePortBtn" 
                                        Margin="10"
                                        Grid.Column="2"
                                        Grid.Row="1"
                                        IsEnabled="{Binding DataChanged}"
                                        Style="{DynamicResource MaterialDesignToolButton}"
                                        Command="{Binding SaveComCmd}" 
                                        HorizontalAlignment="Left">
                                    <materialDesign:PackIcon
                                            Kind="ContentSave"
                                            Opacity=".56" VerticalAlignment="Center" Width="24" Height="24"/>
                                </Button>
                            </Grid>
                            <Grid x:Name="BaudRateSetting"
                                  Grid.Row="1">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition/>
                                    <ColumnDefinition/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="Baud Rate"
               VerticalAlignment="Center"
               Margin="10"/>
                                <ComboBox x:Name="BaudRateSelection" 
                Grid.Column="1"                                            
                IsEditable="False"
                ItemsSource="{Binding BaudRates}" 
                SelectedItem="{Binding UserBaudrate}"                                 >
                                </ComboBox>
                                <Button x:Name="SaveBaudRateBtn" 
            Margin="10"
            Grid.Column="2"
            Grid.Row="1"
            IsEnabled="{Binding DataChanged}"
            Style="{DynamicResource MaterialDesignToolButton}"
            Command="{Binding SaveComCmd}" 
            HorizontalAlignment="Left">
                                    <materialDesign:PackIcon
                Kind="ContentSave"
                Opacity=".56" VerticalAlignment="Center" Width="24" Height="24"/>
                                </Button>
                            </Grid>
                        </Grid>
                    </materialDesign:Card>
                </Grid>
            </TabItem>
            <TabItem x:Name="FramesTab"                     
                     Header="{materialDesign:PackIcon Kind=Code, Size=24}"
                     Style="{StaticResource MaterialDesignNavigationRailTabItem}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition/>
                    </Grid.RowDefinitions>
                    <TextBlock Text="Lista Frame Protocollo" 
                               Style="{DynamicResource MaterialDesignHeadline6TextBlock}"
                               Margin="10"/>
                    <ScrollViewer Grid.Row="1" Margin="10">
                        <DataGrid x:Name="FrameListGrid"
                                  Margin="10"
                                  AlternatingRowBackground="LightGray"
                                  IsReadOnly="True"
                                  AutoGenerateColumns="True"                                  
                                  ItemsSource="{Binding CommResources.FrameTypesView}"/>
                    </ScrollViewer>
                </Grid>
            </TabItem>
        </TabControl>
        <Grid Grid.Row="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition/>
                <ColumnDefinition/>
            </Grid.ColumnDefinitions>
            <TextBlock Text="Frame" 
                       Style="{DynamicResource MaterialDesignHeadline6TextBlock}"
                       Margin="10"/>
            <materialDesign:Card x:Name="ProtocolFrameCard"
                             Grid.Row="1"
                             Margin="10">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <ScrollViewer
                        Margin="10"
                        Grid.Row="1">
                        <TextBox Text="{Binding CommResources.CommandFrameHex}"                          
                        VerticalScrollBarVisibility="Auto"
                        VerticalContentAlignment="Top"
                        myAttachedProperties:TextBoxAttachedProperties.AutoScrollToEnd="True"
                        TextWrapping="Wrap"/>
                    </ScrollViewer>
                    <Button x:Name="SendCurrentCmdBtn"  
                        Grid.Row="1"
                        Margin="10"
                        IsEnabled="{Binding CommResources.CommPortReady}"
                        Grid.Column="3"
                        Style="{DynamicResource MaterialDesignToolButton}"
                        Command="{Binding CommResources.SendCommandCmd}" 
                        VerticalAlignment="Top"
                        HorizontalAlignment="Left">
                        <materialDesign:PackIcon
                        Kind="Send"
                        Opacity=".56" 
                        VerticalAlignment="Center" 
                        Width="24" 
                        Height="24"/>
                    </Button>

                </Grid>
            </materialDesign:Card>
            <materialDesign:Card x:Name="FrameCard"
                                  Margin="10"
                                  materialDesign:ElevationAssist.Elevation="Dp3"
                                  VerticalAlignment="Bottom"
                                  Grid.Row="1"
                                  Grid.Column="1">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="0*"/>
                        <RowDefinition/>
                        <RowDefinition/>
                        <RowDefinition/>
                        <RowDefinition/>
                        <RowDefinition/>
                        <RowDefinition/>
                        <RowDefinition/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition/>
                        <ColumnDefinition/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="Key" 
                Grid.Row="2"
                Margin="5"/>
                    <TextBlock Text="{Binding CommResources.Key}" 
                Grid.Row="2"
                Grid.Column="1"
                Margin="5"/>
                    <TextBlock Text="{Binding CommResources.DeviceKey}" 
                Grid.Row="2"
                Grid.Column="2"
                Margin="5"/>
                    <TextBlock Text="Header Lenght"
                Grid.Row="3"
                Margin="5"/>
                    <TextBlock Text="{Binding CommResources.HeaderLenght}" 
                Grid.Row="3"
                Grid.Column="1"
                Margin="5"/>
                    <TextBlock Text="10" 
                Grid.Row="3"
                Grid.Column="2"
                Margin="5"/>
                    <TextBlock Text="Frame Type" 
                Grid.Row="4"
                Margin="5"/>
                    <TextBlock Text="{Binding CommResources.FrameTypeStr}" 
                Grid.Row="4"
                Grid.Column="1"
                Margin="5"/>
                    <TextBlock Text="{Binding CommResources.FrameTypeCode}" 
                Grid.Row="4"
                Grid.Column="2"
                Margin="5"/>
                    <TextBlock Text="Data Type (Tipo)" 
                FontWeight="Bold"
                Grid.Row="5"
                Margin="5"/>
                    <TextBlock Text="{Binding CommResources.DataType}" 
                Grid.Row="5"
                Grid.Column="1"
                Margin="5"/>
                    <TextBlock Text="{Binding CommResources.FrameDataType}" 
                Visibility="{Binding CommResources.WriteFrameDataVisibility}"
                Grid.Row="5"
                Grid.Column="2"
                Margin="5"/>
                    <TextBlock Text="Non necessario (0)" 
                Visibility="{Binding CommResources.ReadFrameDataVisibility}"
                Grid.Row="5"
                Grid.Column="2"
                Margin="5"/>
                    <TextBlock Text="Data Lenght" 
                Grid.Row="6"
                Margin="5"/>
                    <TextBlock Text="{Binding CommResources.DataLenght}" 
                Grid.Row="6"
                Grid.Column="1"
                Margin="5"/>
                    <TextBlock Text="Non necessario (0)" 
                Visibility="{Binding CommResources.ReadFrameDataVisibility}"
                Grid.Row="6"
                Grid.Column="2"
                Margin="5"/>
                    <TextBlock Text="{Binding CommResources.DataLenghtValue}" 
                Visibility="{Binding CommResources.WriteFrameDataVisibility}"
                Grid.Row="6"
                Grid.Column="2"
                Margin="5"/>
                    <TextBlock Text="Address (Indirizzo Protocollo)" 
                FontWeight="Bold"
                Grid.Row="7"
                Margin="5"/>
                    <TextBlock Text="{Binding CommResources.Address}" 
                Grid.Row="7"
                Grid.Column="1"
                Margin="5"/>
                    <TextBlock Text="{Binding CommResources.AddressVal}" 
                Grid.Row="7"
                Grid.Column="2"
                Margin="5"/>
                    <TextBlock Text="CRC16-CCIT (0xFFFF)" 
                Grid.Row="8"
                Margin="5"/>
                    <TextBlock Text="{Binding CommResources.Crc}" 
Grid.Row="8"
Grid.Column="1"
Margin="5"/>
                </Grid>
            </materialDesign:Card>
        </Grid>
        <materialDesign:ColorZone
Background="LightGray"
Height="Auto"                    
VerticalAlignment="Stretch"
materialDesign:ElevationAssist.Elevation="Dp1"            
CornerRadius="3"
Grid.Row="2"
Grid.ColumnSpan="2"
Margin="10,10,10,10">
            <TextBlock                                    
               Margin="10"
               FontWeight="Bold"
               HorizontalAlignment="Center"
               VerticalAlignment="Center">
            <Run Text="{Binding CommResources.XmlFileName}"/>
            <Run Text="  -  "/>
            <Run Text="{Binding CommResources.UserCommPort}"/>
            </TextBlock>
        </materialDesign:ColorZone>
    </Grid>
</Window>
